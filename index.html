<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tab Manager with Environments</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="images/favicon.png" type="image/png">
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.163.0.min.js"></script>
    
    <!-- Base Styles -->
    <link rel="stylesheet" href="css/base.css">
    <!-- What is inside base.css : Reset and global box-sizing; Root variables for consistent theming; Base body styles -->

    <!-- Layout -->
    <link rel="stylesheet" href="css/layout.css">
    <!-- Main header styling; Logo and counters area; Main container for side panel and content; Side panel navigation; Main content area -->

    <!-- Reusable components -->
    <link rel="stylesheet" href="css/components.css">
    <!-- Environment component styles; Tab component styles; Link card grid layout; Button components; Action buttons -->

    <!-- Bulk actions -->
    <link rel="stylesheet" href="css/bulk-actions.css">
    <!-- Bulk action bar - fixed at bottom; Bulk action buttons; Selection mode toggle -->

    <!-- Modal & dropdown components -->
    <link rel="stylesheet" href="css/modal-components.css">
    <!-- Color picker components; Enhanced color picker; View type dropdown -->

    <!-- Move components -->
    <link rel="stylesheet" href="css/move-components.css">
    <!-- Cross-profile movement styles; Destination selection styles; Selected destination path indicator -->

    <!-- Email components -->
    <link rel="stylesheet" href="css/email-components.css">
    <!-- Outlook email modal styles; Form group styles -->

    <!-- Environment components -->
    <link rel="stylesheet" href="css/environment-components.css">
    <!-- Environment container with scroll; Environment item styling; Environment actions; Specific environment button colors; Environment expand/collapse animation; Chevron rotation with smooth animation; Add environment button -->

    <!-- Link components -->
    <link rel="stylesheet" href="css/link-components.css">
    <!-- Link card grid layout; Grid link card; Grid link content; Grid link actions; Grid action button variants; List view; List link item; List link content; List link main; List link header; List link icon; List link title; List link type; List link url; List link url text; List link actions; List action button; Table view; Table action buttons; Table action button variants; Table content styling -->

    <!-- Selection modes -->
    <link rel="stylesheet" href="css/selection-modes.css">
    <!-- Grid view selection; List view selection; Table view selection -->

    <!-- Responsive design -->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- Tablet devices (768px and below); Mobile devices (480px and below) -->

    <!-- Header actions -->
    <link rel="stylesheet" href="css/header-actions-new.css">
    <!-- Header actions; Specific header button variants -->

    <!-- Links container & main content -->
    <link rel="stylesheet" href="css/links-container.css">
    <!-- Main links container with scrolling; No links message styling -->

    <!-- Enhanced grid view styles -->
    <link rel="stylesheet" href="css/grid-view-enhanced.css">
    <!-- Grid layout with forced constraints; Grid card with strict sizing; Grid card content; URL styling with proper text handling; Grid action buttons; Grid action button variants -->

    <!-- Add link form components -->
    <link rel="stylesheet" href="css/add-link-form.css">
    <!-- Sticky add link section at bottom; Add link form; Form group; Form group label; Form group input; Add link button -->

    <!-- Modal base styles -->
    <link rel="stylesheet" href="css/modal-base.css">
    <!-- Modal overlay; Modal content container; Modal header; Modal title; Modal close button; Modal form elements; Modal action buttons; Modal button variants -->

    <!-- Move modal components -->
    <link rel="stylesheet" href="css/move-modals.css">
    <!-- Move link modal specific styles; Move profile container; Move profile content with expand/collapse; Chevron rotation for expanded state; Move profile header; Move tab profile header; Move environment workbook header -->

    <!-- Move tree view components -->
    <link rel="stylesheet" href="css/move-tree-view.css">
    <!-- Tree view container; Tree structure - Workbook level; Tree structure - Profile level; Tree structure - Environment level; Tree icons and styling; Tree badges and info; Radio buttons in tree; Tree container indentation -->

    <!-- Move environment components -->
    <link rel="stylesheet" href="css/move-environment-components.css">
    <!-- Environment movement components; Move tab environment items; Move link tab items -->

    <!-- Multi-link components -->
    <link rel="stylesheet" href="css/multi-link-components.css">
    <!-- Multi-link form fields; Multi-link action buttons; Multi-link count badge -->

    <!-- Destination path display -->
    <link rel="stylesheet" href="css/destination-path.css">
    <!-- Selected destination path indicator; No destinations message -->

    <!-- Panel titles & headers -->
    <link rel="stylesheet" href="css/panel-titles.css">
    <!-- Side panel section titles -->

    <!-- Profile tabs -->
    <link rel="stylesheet" href="css/profile-tabs.css">
    <!-- Profile tabs container with horizontal scrolling; Individual profile tab; Profile color indicator; Profile tab name; Profile tab actions; Specific profile action colors; Add profile tab button; Hide old profile selector -->

    <!-- Workbook tabs -->
    <link rel="stylesheet" href="css/workbook-tabs.css">
    <!-- Workbook tabs container; Individual workbook tab; Workbook color indicator (right side); Workbook tab name; Workbook tab actions; Specific workbook action colors; Add workbook tab button -->

    <!-- Side panel tabs -->
    <link rel="stylesheet" href="css/side-panel-tabs.css">
    <!-- Enhanced side panel with proper dimensions; Tabs list with scrolling; Individual tab items; Tab action buttons; Tab action button variants; Add tab container -->

    <!-- Content panel -->
    <link rel="stylesheet" href="css/content-panel.css">
    <!-- Main content panel; Tab header in content panel -->

    <!-- Search & filter components -->
    <link rel="stylesheet" href="css/search-components.css">
    <!-- Search container; Search clear button; Search count badge -->

    <!-- Search highlights -->
    <link rel="stylesheet" href="css/search-highlights.css">
    <!-- Search highlight for text content; Search result highlighting for different element types; Active state with search highlights; Hover states with search highlights; Search highlight animation -->

    <!-- Search suggestions -->
    <link rel="stylesheet" href="css/search-suggestions.css">
    <!-- Search suggestions container; Search suggestion items; Search suggestion icons; Search suggestion content; Search suggestion title; Search suggestion type; Search suggestion path; Search suggestion highlight -->

    <!-- Trash bin -->
    <link rel="stylesheet" href="css/trash-bin.css">
    <!-- Trash bin button in header; Trash bin modal; Trash bin items; Trash bin actions; Trash bin restore button; Trash bin permanently delete button; Trash bin clear all button; Empty trash bin state -->

    <!-- Modal specific styles -->
    <link rel="stylesheet" href="css/modal-specific.css">
    <!-- Profile modal; Color preview in modals; Rename modal; Environment modal; Workbook modal; Search link modal -->

    <!-- Reorder components -->
    <link rel="stylesheet" href="css/reorder-components.css">
    <!-- Reorder links modal; Reorder link items -->

    <!-- S3 sync components -->
    <link rel="stylesheet" href="css/s3-sync-new.css">
    <!-- S3 sync button; Sync status messages -->

    <!-- Selection components -->
    <link rel="stylesheet" href="css/selection-components.css">
    <!-- Link selection checkboxes; Selection instructions -->

    <!-- Add Tab Button Styling - matching view type dropdown -->
    <link rel="stylesheet" href="css/add-tab-button.css">
    <!-- Add Tab Button Styling - matching view type dropdown -->




</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="logo">
            <img src="images/50pxX55px.png" alt="Tab Manager" class="logo-image">
            <span>Tab Manager</span>
                <div class="counters">
                <span class="counter-item" id="workbooks-counter">0 Workbooks</span>
                <span class="counter-item" id="profiles-counter">0 Profiles</span>
                <span class="counter-item" id="environments-counter">0 Environments</span>
                <span class="counter-item" id="tabs-counter">0 Tabs</span>
                <span class="counter-item" id="links-counter">0 Links</span>
            </div>
        </div>
        <div class="search-container">
            <i class="fas fa-search"></i>
            <input type="text" id="global-search" placeholder="Search across all workbooks...">
            <span class="search-clear" id="search-clear">
                <i class="fas fa-times"></i>
            </span>
            <!-- Search suggestions should be a sibling of the input -->
            <div class="search-suggestions" id="search-suggestions" style="display: none;">
                <div class="search-suggestions-header">
                    <span>Search Results</span>
                    <small id="search-results-count">0 results</small>
                </div>
                <div class="search-suggestions-list" id="search-suggestions-list">
                    <!-- Suggestions will be populated here -->
                </div>
            </div>
        </div>
        <div class="header-actions">
            <button class="trash-bin-btn" id="trash-bin-btn" title="Trash Bin">
                <i class="fas fa-trash"></i>Trash Bin
            </button>
            <button class="header-btn reorder-workbooks-btn" id="reorder-workbooks-btn" title="Reorder Workbooks">
                <i class="fas fa-sort"></i>Reorder Workbooks
            </button>
            <button class="header-btn reorder-profiles-btn" id="reorder-profiles-btn" title="Reorder Profiles">
                <i class="fas fa-sort"></i>Reorder Profiles
            </button>
            <button class="header-btn export-btn" id="export-btn">
                <i class="fas fa-download"></i>Export to XML
            </button>
            <button class="header-btn import-btn" id="import-btn">
                <i class="fas fa-upload"></i>Import from XML
            </button>
            <button class="header-btn" id="migrate-data-btn" style="background: #e67e22;">
                <i class="fas fa-history"></i>Migrate Old Data
            </button>
            
        </div>
    </div>

    <!-- NEW: Workbook tabs -->
    <div class="workbook-tabs-container" id="workbook-tabs-container">
        <!-- Workbook tabs will be added here dynamically -->
        <button class="add-workbook-tab" id="add-workbook-tab-btn" title="Add New Workbook">
            <i class="fas fa-plus"></i>
        </button>
    </div>

    <!-- NEW: Profile tabs -->
    <div class="profile-tabs-container" id="profile-tabs-container">
        <!-- Profile tabs will be added here dynamically -->
        <button class="add-profile-tab" id="add-profile-tab-btn" title="Add New Profile">
            <i class="fas fa-plus"></i>
        </button>
    </div>
    
     <!-- Main Content -->
    <div class="main-container">
        <!-- Left Frame - Side Panel -->
        <div class="side-panel">
            <!-- Profile Selector (hidden) -->
            <div class="profiles-container">
                <div class="profile-selector">
                    <select class="profile-select" id="profile-select"></select>
                    <button class="profile-action-btn" id="add-profile-btn" title="Add New Profile">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button class="profile-action-btn" id="edit-profile-btn" title="Rename Profile">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="profile-action-btn" id="delete-profile-btn" title="Delete Profile">
                        <i class="fas fa-trash"></i>
                    </button>
                    <!-- <button class="header-btn reorder-profiles-btn" id="reorder-profiles-btn" title="Reorder Profiles" style="margin-left: 10px;"> -->
                    <!--     <i class="fas fa-sort"></i>Reorder Profiles -->
                    <!-- </button> -->
                </div>
            </div>
            
            <div class="panel-title">
                <span>My Environments</span>
                <div>
                    <button class="add-environment-btn" id="reorder-environments-btn" title="Reorder Environments" style="margin-right: 10px;">
                        <i class="fas fa-sort"></i>
                    </button>
                    <button class="add-environment-btn" id="add-environment-btn" title="Add New Environment">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
            <div class="environments-container" id="environments-container">
                <!-- Environments will be added here dynamically -->
            </div>
            
        </div>
        
        
        <!-- Right Frame - Content Panel -->
        <div class="content-panel">
            <div class="tab-header">
                <div class="tab-title" id="current-tab-name">Select a tab to get started</div>
                <div class="tab-actions">
                    <div class="view-type-dropdown">
                        <button class="view-type-toggle" id="view-type-toggle">
                            <i class="fas fa-th"></i>
                            <span>View</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="view-type-menu" id="view-type-menu">
                            <button class="view-type-option" data-view-type="grid">
                                <i class="fas fa-th"></i>
                                <span>Grid View</span>
                            </button>
                            <button class="view-type-option" data-view-type="list">
                                <i class="fas fa-list"></i>
                                <span>List View</span>
                            </button>
                            <button class="view-type-option" data-view-type="table">
                                <i class="fas fa-table"></i>
                                <span>Table View</span>
                            </button>
                        </div>
                    </div>

                    <!-- MOVED: Add Tab Button -->
                    <button class="add-tab" id="add-tab-btn">
                        <i class="fas fa-plus plus-icon"></i> New Tab
                    </button>
                    <button id="toggle-selection-mode-btn" style="display: none;">
                        <i class="fas fa-check-square"></i>Select Links
                    </button>
                    <button id="reorder-links-btn" style="display: none;">
                        <i class="fas fa-sort"></i>Reorder Links
                    </button>
                    <button id="add-multi-link-card-btn" style="display: none;">
                        <i class="fas fa-layer-group"></i>Add Multi-Link Card
                    </button>
                    <button id="create-search-link-btn" style="display: none;">
                        <i class="fas fa-search-plus"></i>Create Search Link
                    </button>
                    <button class="header-btn" id="create-outlook-email-btn" style="background: #0078d4;">
                        <i class="fas fa-envelope"></i>Create Outlook Email
                    </button>
                    <button id="add-link-btn">
                        <i class="fas fa-plus plus-icon"></i>Add Link
                    </button>
                </div>
            </div>
            
            <div class="links-container" id="links-container">
                <div class="no-links-message" id="no-tabs-message">
                    <h2>Welcome to Tab Manager</h2>
                    <p>Create your first workbook, profile, environment and tab to get started!</p>
                </div>
                
                <div class="links-grid" id="links-grid" style="display: none;">
                    <!-- Links will be added here dynamically -->
                </div>
            </div>
            
            <div class="add-link-section" id="add-link-section" style="display: none;">
                <div class="add-link-form">
                    <div class="form-group">
                        <label for="link-title">Title</label>
                        <input type="text" id="link-title" placeholder="Enter link title">
                    </div>
                    <div class="form-group">
                        <label for="link-url">URL</label>
                        <input type="text" id="link-url" placeholder="https://example.com">
                    </div>
                    <button class="add-link-btn" id="add-link-submit-btn">Add Link</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Workbook Modal -->
    <div class="modal" id="workbook-modal">
        <div class="workbook-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Workbook</h3>
                <span class="close-modal">&times;</span>
            </div>
            <input type="text" class="rename-input" id="new-workbook-name" placeholder="Enter workbook name">
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-workbook-modal">Cancel</button>
                <button class="modal-btn modal-btn-primary" id="save-workbook-btn">Save</button>
            </div>
        </div>
    </div>

      
    <!-- Export Modal -->
    <div class="modal" id="export-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Export to XML</h3>
                <span class="close-modal">&times;</span>
            </div>
            <p>Copy this XML to save your environments, tabs and links:</p>
            <textarea class="modal-textarea" id="export-xml-content" readonly></textarea>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-export-modal">Close</button>
                <button class="modal-btn modal-btn-primary" id="copy-xml-btn">
                    <i class="fas fa-copy"></i>Copy to Clipboard
                </button>
                <button class="modal-btn modal-btn-success" id="download-xml-btn">
                    <i class="fas fa-download"></i>Download XML File
                </button>
            </div>
        </div>
    </div>

    <!-- Import Modal -->
    <div class="modal" id="import-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Import from XML</h3>
                <span class="close-modal">&times;</span>
            </div>
            <p>Paste your XML data here to import environments, tabs and links:</p>
            <textarea class="modal-textarea" id="import-xml-content" placeholder="Paste XML here..."></textarea>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-import-modal">Close</button>
                <button class="modal-btn modal-btn-success" id="import-xml-btn">
                    <i class="fas fa-file-import"></i>Import Data
                </button>
            </div>
        </div>
    </div>

    <!-- Add Environment Modal -->
    <div class="modal" id="environment-modal">
        <div class="environment-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Environment</h3>
                <span class="close-modal">&times;</span>
            </div>
            <input type="text" class="rename-input" id="new-environment-name" placeholder="Enter environment name">
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-environment-modal">Cancel</button>
                <button class="modal-btn modal-btn-primary" id="save-environment-btn">Save</button>
            </div>
        </div>
    </div>

    <!-- Add Tab Modal -->
    <div class="modal" id="tab-modal">
        <div class="rename-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Tab</h3>
                <span class="close-modal">&times;</span>
            </div>
            <input type="text" class="rename-input" id="new-tab-name" placeholder="Enter tab name">
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-tab-modal">Cancel</button>
                <button class="modal-btn modal-btn-primary" id="save-tab-btn">Save</button>
            </div>
        </div>
    </div>

    <!-- Update the move link modal to include the destination path -->
    <div class="modal" id="move-link-modal">
        <div class="move-link-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Move Link</h3>
                <span class="close-modal">&times;</span>
            </div>
            <p>Select a destination tab for this link:</p>
            
            <!-- Add the destination path display here -->
            <div class="selected-destination-path" id="selected-destination-path" style="display: none;">
                <!-- Selected path will be shown here -->
            </div>
            
            <div id="move-link-destinations">
                <!-- Destinations will be populated here -->
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-move-link-modal">Cancel</button>
                <button class="modal-btn modal-btn-primary" id="save-move-link-btn">Move</button>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div class="modal" id="profile-modal">
        <div class="profile-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Profile</h3>
                <span class="close-modal">&times;</span>
            </div>
            <input type="text" class="rename-input" id="new-profile-name" placeholder="Enter profile name">
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-profile-modal">Cancel</button>
                <button class="modal-btn modal-btn-primary" id="save-profile-btn">Save</button>
            </div>
        </div>
    </div>

    <!-- Add Multi-Link Card Modal -->
    <div class="modal" id="multi-link-card-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add Multi-Link Card</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="form-group">
                <label for="multi-link-card-name">Card Name</label>
                <input type="text" id="multi-link-card-name" placeholder="Enter card name">
            </div>
            <div id="multi-link-fields-container">
                <div class="multi-link-field">
                    <label>Link 1</label>
                    <div class="link-input-with-action">
                        <input type="text" class="multi-link-url" placeholder="https://example.com">
                        <button type="button" class="add-link-field-btn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-multi-link-card-modal">Cancel</button>
                <button class="modal-btn modal-btn-primary" id="save-multi-link-card-btn">Save</button>
            </div>
        </div>
    </div>

    <!-- Edit Multi-Link Card Modal -->
    <div class="modal" id="edit-multi-link-card-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Edit Multi-Link Card</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="form-group">
                <label for="edit-multi-link-card-name">Card Name</label>
                <input type="text" id="edit-multi-link-card-name" placeholder="Enter card name">
            </div>
            <div id="edit-multi-link-fields-container">
                <!-- Dynamic fields will be added here -->
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-edit-multi-link-card-modal">Cancel</button>
                <button class="modal-btn modal-btn-primary" id="save-edit-multi-link-card-btn">Save</button>
            </div>
        </div>
    </div>

   <!-- Create Search Link Modal -->
    <div class="modal" id="create-search-link-modal">
        <div class="search-link-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create Search Link</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="search-link-description">
                Create a link with a search parameter that can be filled when opening the link.
            </div>
            <div class="form-group">
                <label for="search-link-title">Title</label>
                <input type="text" id="search-link-title" placeholder="Enter link title">
            </div>
            <div class="form-group">
                <label for="search-link-url">URL with Search Parameter</label>
                <input type="text" id="search-link-url" placeholder="https://example.com/search?q={search}">
            </div>
            <div class="search-link-preview" id="search-link-preview">
                Preview: <span id="search-link-preview-text">Enter URL to see preview</span>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-create-search-link-modal">Cancel</button>
                <button class="modal-btn modal-btn-primary" id="save-search-link-btn">Create Search Link</button>
            </div>
        </div>
    </div>

    <!-- Search Value Input Modal -->
    <div class="modal" id="search-value-modal">
        <div class="rename-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Enter Search Value</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="search-link-preview" id="search-value-preview">
                URL: <span id="search-value-preview-text"></span>
            </div>
            <input type="text" class="rename-input" id="search-value-input" placeholder="Enter search value">
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-search-value-modal">Cancel</button>
                <button class="modal-btn modal-btn-primary" id="open-search-link-btn">Open Link</button>
            </div>
        </div>
    </div>

    <!-- Search Suggestions Dropdown -->
    <!-- <div class="search-suggestions" id="search-suggestions" style="display: none;"> -->
    <!--     <div class="search-suggestions-header"> -->
    <!--         <span>Search Results</span> -->
    <!--         <small id="search-results-count">0 results</small> -->
    <!--     </div> -->
    <!--     <div class="search-suggestions-list" id="search-suggestions-list"> -->
            <!-- Suggestions will be populated here -->
    <!--     </div> -->
    <!-- </div> -->

    <!-- Bulk Action Bar -->
    <div class="bulk-action-bar" id="bulk-action-bar">
        <div class="bulk-selection-count" id="bulk-selection-count">0 items selected</div>
        <button class="bulk-action-btn bulk-clone-btn" id="bulk-clone-to-tab-btn">
            <i class="fas fa-copy"></i>Clone to Tab
        </button>
        <button class="bulk-action-btn bulk-clone-btn" id="bulk-clone-btn">
            <i class="fas fa-copy"></i>Clone Selected
        </button>
        <button class="bulk-action-btn bulk-move-btn" id="bulk-move-btn">
            <i class="fas fa-arrows-alt"></i>Move Selected
        </button>
        <button class="bulk-action-btn bulk-delete-btn" id="bulk-delete-btn">
            <i class="fas fa-trash"></i>Delete Selected
        </button>
        <button class="bulk-action-btn bulk-cancel-btn" id="bulk-cancel-btn">
            <i class="fas fa-times"></i>Cancel
        </button>
    </div>

    <!-- Clone to Tab Modal -->
    <div class="modal" id="clone-to-tab-modal">
        <div class="move-link-modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="clone-modal-title">Clone Links to Tab</h3>
                <span class="close-modal">&times;</span>
            </div>
            <p>Select a destination tab for the cloned links:</p>
            <div id="clone-link-destinations">
                <!-- Destinations will be populated here -->
            </div>
            <div class="selected-destination-path" id="clone-destination-path" style="display: none;">
                <!-- Selected path will be shown here -->
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-clone-to-tab-modal">Cancel</button>
                <button class="modal-btn modal-btn-primary" id="save-clone-to-tab-btn">
                    <i class="fas fa-copy"></i>Clone Links
                </button>
            </div>
        </div>
    </div>

    <div class="modal" id="trash-bin-modal">
        <div class="trash-bin-modal-content">
            <div class="trash-bin-header">
                <h3 class="modal-title">Trash Bin</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="trash-bin-count" id="trash-bin-count">0 items in trash</div>
            <div id="trash-bin-items">
                <!-- Trash bin items will be populated here -->
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-trash-bin-modal">Close</button>
                <button class="modal-btn trash-bin-clear-all-btn" id="clear-trash-bin-btn">
                    <i class="fas fa-trash"></i>Empty Trash Bin
                </button>
            </div>
        </div>
    </div>

    <!-- Outlook Email Modal -->
    <div class="modal" id="outlook-email-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create Outlook Email Link</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="form-group">
                <label for="email-from">From (optional - usually auto-filled by Outlook)</label>
                <input type="email" id="email-from" placeholder="sender@example.com">
            </div>
            <div class="form-group">
                <label for="email-to">To (required, separate multiple with semicolons)</label>
                <input type="text" id="email-to" placeholder="recipient1@example.com; recipient2@example.com" required>
            </div>
            <div class="form-group">
                <label for="email-cc">CC (optional, separate multiple with semicolons)</label>
                <input type="text" id="email-cc" placeholder="cc1@example.com; cc2@example.com">
            </div>
            <div class="form-group">
                <label for="email-subject">Subject (optional)</label>
                <input type="text" id="email-subject" placeholder="Email subject">
            </div>
            <div class="form-group">
                <label for="email-body">Body (optional)</label>
                <textarea id="email-body" placeholder="Email body content" rows="4"></textarea>
            </div>
            <div class="email-preview" id="email-preview">
                <strong>Preview:</strong> <span id="email-preview-text">mailto:...</span>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" id="close-outlook-email-modal">Cancel</button>
                <button class="modal-btn modal-btn-primary" id="save-outlook-email-btn">Create Email Link</button>
            </div>
        </div>
    </div>

    
    <script>
        // Updated data structure with workbooks
        let workbooks = [];
        let currentWorkbookId = null;
        let currentProfileId = null;
        let currentEnvironment = null;
        let currentTab = null;
        let linkToMove = null;
        let tabToMove = null;
        let linkToEdit = null;
        let environmentToRename = null;
        let tabToRename = null;
        let profileToRename = null;
        let workbookToRename = null;
        let selectedDestinationTab = null;
        let selectedDestinationEnvironment = null;
        let environmentToMove = null;
        let selectedDestinationProfile = null;
        let multiLinkCardToEdit = null;
        let selectedColor = '#3498db';
        let profileForColor = null;
        let searchLinkToOpen = null;
        let isCreatingSearchLink = false;
        let selectedLinks = new Set();
        let isSelectionMode = false;
        let currentViewType = 'grid';
        let trashBin = [];

        // DOM Elements
        const workbookTabsContainer = document.getElementById('workbook-tabs-container');
        const addWorkbookTabBtn = document.getElementById('add-workbook-tab-btn');
        const environmentsContainer = document.getElementById('environments-container');
        const linksGrid = document.getElementById('links-grid');
        const noTabsMessage = document.getElementById('no-tabs-message');
        const currentTabName = document.getElementById('current-tab-name');
        const addLinkSection = document.getElementById('add-link-section');
        const addLinkSubmitBtn = document.getElementById('add-link-submit-btn');
        const reorderLinksBtn = document.getElementById('reorder-links-btn');
        const addTabBtn = document.getElementById('add-tab-btn');
        const addEnvironmentBtn = document.getElementById('add-environment-btn');
        const exportBtn = document.getElementById('export-btn');
        const importBtn = document.getElementById('import-btn');
        const exportModal = document.getElementById('export-modal');
        const importModal = document.getElementById('import-modal');
        const environmentModal = document.getElementById('environment-modal');
        const renameEnvironmentModal = document.getElementById('rename-environment-modal');
        const tabModal = document.getElementById('tab-modal');
        const renameTabModal = document.getElementById('rename-tab-modal');
        const editLinkModal = document.getElementById('edit-link-modal');
        const moveLinkModal = document.getElementById('move-link-modal');
        const moveTabModal = document.getElementById('move-tab-modal');
        const reorderLinksModal = document.getElementById('reorder-links-modal');
        const profileModal = document.getElementById('profile-modal');
        const renameProfileModal = document.getElementById('rename-profile-modal');
        const profileTabsContainer = document.getElementById('profile-tabs-container');
        const addProfileTabBtn = document.getElementById('add-profile-tab-btn');
        const globalSearch = document.getElementById('global-search');
        const searchClear = document.getElementById('search-clear');
        const workbookModal = document.getElementById('workbook-modal');
        const renameWorkbookModal = document.getElementById('rename-workbook-modal');
        const reorderWorkbooksModal = document.getElementById('reorder-workbooks-modal');  
        const originalSaveWorkbooks = window.saveWorkbooks;
        // Add a test button to your HTML temporarily (you can remove this later)
        const testButton = document.createElement('button');
        testButton.textContent = 'Test Move Tab Modal';
        testButton.style.position = 'fixed';
        testButton.style.top = '10px';
        testButton.style.right = '10px';
        testButton.style.zIndex = '10000';
        testButton.onclick = testMoveTabModal;
        document.body.appendChild(testButton);


        window.saveWorkbooks = function() {
            console.trace('saveWorkbooks called from:');
            return originalSaveWorkbooks.apply(this, arguments);
        };
        
        // Add this to your main script section for debugging
        function debugAvailableFunctions() {
            console.log('=== Available Functions Debug ===');
            console.log('openTrashBinModal:', typeof openTrashBinModal);
            console.log('initReorderWorkbooksModal:', typeof initReorderWorkbooksModal);
            console.log('initReorderProfilesModal:', typeof initReorderProfilesModal);
            console.log('openExportModal:', typeof openExportModal);
            console.log('importFromXML:', typeof importFromXML);
            console.log('forceMigrateOldData:', typeof forceMigrateOldData);
            console.log('migrateOldData:', typeof migrateOldData);
            console.log('addWorkbook:', typeof addWorkbook);
            console.log('addProfile:', typeof addProfile);
            console.log('=== End Debug ===');
        }

        function debugProfileTabsScrolling() {
            const profileTabsContainer = document.querySelector('.profile-tabs-container');
            
            console.log('=== Profile Tabs Scrolling Debug ===');
            console.log('Container:', profileTabsContainer);
            console.log('Scroll width:', profileTabsContainer.scrollWidth);
            console.log('Client width:', profileTabsContainer.clientWidth);
            console.log('Can scroll horizontally:', profileTabsContainer.scrollWidth > profileTabsContainer.clientWidth);
            console.log('CSS overflow-x:', getComputedStyle(profileTabsContainer).overflowX);
            console.log('CSS overflow-y:', getComputedStyle(profileTabsContainer).overflowY);
            
            // Check if any parent has overflow hidden
            let parent = profileTabsContainer.parentElement;
            while (parent) {
                const overflow = getComputedStyle(parent).overflow;
                if (overflow === 'hidden') {
                    console.log('Parent with overflow hidden:', parent);
                }
                parent = parent.parentElement;
            }
            
            // Test if wheel events are being captured
            profileTabsContainer.addEventListener('wheel', (e) => {
                console.log('Wheel event on profile tabs:', e);
            }, { passive: false });
        }

        // ===== VERSION-AWARE STORAGE MANAGER =====
        const APP_VERSION = 'v18-search'; // UNIQUE FOR V18

        function init() {
            console.log('Initializing V18 Tab Manager...');
            
            // Migrate to versioned storage first
            migrateToVersionedStorage();
            
            // Load versioned data
            loadWorkbooks();
            loadTrashBin();

            // Ensure environments are collapsed by default
            ensureEnvironmentsCollapsed();
            
            debugCurrentState();
            const duplicates = findDuplicateElements();
            
            // Continue with existing initialization
            migrateOldData();
            
            // Create default workbook if none exist
            if (workbooks.length === 0) {
                createDefaultWorkbook();
            }
            
            // Set initial selections - FIXED: Ensure profile is selected
            if (workbooks.length > 0) {
                currentWorkbookId = workbooks[0].id;
                
                const currentWorkbook = getCurrentWorkbook();
                // Auto-select first profile
                if (currentWorkbook && currentWorkbook.profiles && currentWorkbook.profiles.length > 0) {
                    currentProfileId = currentWorkbook.profiles[0].id;
                } else {
                    // If no profiles, create a default one
                    createDefaultProfile();
                }
                
                renderWorkbookTabs();
                renderProfileTabs();
                renderEnvironments();
            }

            setTimeout(workingProfileTabsScroll, 100);
            
            setupSearchFunctionality();
            // Debug: Check available functions
            setTimeout(debugAvailableFunctions, 1000);

            setTimeout(debugProfileTabsScrolling, 1000);

            // Initialize counters
            if (typeof updateAllCounters === 'function') {
                updateAllCounters();
            }
            
            // Setup event listeners
            if (typeof setupEventListeners === 'function') {
                const success = setupEventListeners();
                if (!success) {
                    console.error('Failed to setup event listeners');
                    setTimeout(setupEventListeners, 100);
                }
            }
            
            setupProfileTabsScrolling();
            positionSearchSuggestions();
            
            // Optional: Auto-refresh counters every 3 seconds as backup
            setInterval(() => {
                if (typeof updateAllCounters === 'function') {
                    updateAllCounters();
                }
            }, 3000);
            
            console.log(`V18 Tab Manager initialized successfully with version: ${APP_VERSION}`);

            setTimeout(verifyAllFixes, 500);
            
        }

        // Add this to your main script section after workbooks is defined
        // Make workbooks globally accessible
        window.getTabManagerWorkbooks = function() {
            return workbooks || [];
        };
        
        window.getTabManagerCurrentWorkbook = function() {
            return getCurrentWorkbook();
        };
        
        window.getTabManagerCurrentProfile = function() {
            return getCurrentProfile();
        };
                          
                
        // Initialize the application when the page loads
        document.addEventListener('DOMContentLoaded', init);

        // Add this temporary test function to your main script
        function testMoveTabModal() {
            if (currentTab) {
                console.log('Testing move tab modal with current tab:', currentTab);
                window.openMoveTabModal(currentTab);
            } else {
                // Create a test tab
                const testTab = { id: 'test-tab', name: 'Test Tab' };
                console.log('Testing move tab modal with test tab:', testTab);
                window.openMoveTabModal(testTab);
            }
        }

        // Temporary fix to ensure workbooks is globally accessible
        (function() {
            // Wait for the main app to initialize
            setTimeout(() => {
                console.log('Making workbooks globally accessible...');
                
                // Ensure workbooks is available on window
                if (typeof workbooks !== 'undefined' && !window.workbooks) {
                    window.workbooks = workbooks;
                    console.log('Workbooks attached to window:', window.workbooks.length);
                }
                
                // Also create a global function to get workbooks
                window.getGlobalWorkbooks = function() {
                    return workbooks || window.workbooks || [];
                };
            }, 1000);
        })();
    </script>

    <!-- 1. Core utilities first -->
    <script src="js/getCurrentProfile.js"></script>
    <!-- what function is inside: getCurrentProfile -->
    <script src="js/getCurrentWorkbook.js"></script>
    <!-- what function is inside: getCurrentWorkbook -->

    <!-- 2. Rendering functions that renderEnvironments depends on -->
    <script src="js/renderTabs.js"></script>
    <!-- what function is inside: renderTabs -->

    <!-- 3. renderEnvironments itself -->
    <script src="js/render-environments.js"></script>
    <!-- what function is inside: renderEnvironments -->
   
    <script src="js/importSearchLink.js"></script>
    <!-- what function is inside: importSearchLink -->
    <script src="js/openMoveLinkModal.js"></script>
    <!-- what function is inside: openMoveLinkModal -->
    <script src="js/exportToXML.js"></script>
    <!-- what function is inside: exportToXML; openExportModal; downloadXMLFile; escapeXml -->
    <script src="js/addCheckboxesToAllViews.js"></script>
    <!-- what function is inside: addCheckboxesToAllViews; addCheckboxToElement; removeCheckboxesFromLinks -->
    <script src="js/addCheckboxesToGridView.js"></script>
    <!-- what function is inside: addCheckboxesToGridView -->
    <script src="js/addCheckboxesToListView.js"></script>
    <!-- what function is inside: addCheckboxesToListView -->
    <script src="js/addCheckboxesToTableView.js"></script>
    <!-- what function is inside: addCheckboxesToTableView -->
    <script src="js/addCheckboxToElement.js"></script>
    <!-- what function is inside: addCheckboxToElement -->
    <script src="js/removeCheckboxesFromLinks.js"></script>
    <!-- what function is inside: removeCheckboxesFromLinks -->
    <script src="js/checkProfileScroll.js"></script>
    <!-- what function is inside: checkProfileScroll -->
     <script src="js/updateProfileScroll.js"></script>
    <!-- what function is inside: updateProfileScroll; setupProfileTabsScrolling -->
    <script src="js/permanentlyDeleteFromTrash.js"></script>
    <!-- what function is inside: permanentlyDeleteFromTrash -->
    <script src="js/restoreFromTrash.js"></script>
    <!-- what function is inside: restoreFromTrash -->
    <script src="js/moveWorkbookUp.js"></script>
    <!-- what function is inside: moveWorkbookUp -->
    <script src="js/moveWorkbookDown.js"></script>
    <!-- what function is inside: moveWorkbookDown -->
    <script src="js/deleteWorkbook.js"></script>
    <!-- what function is inside: deleteWorkbook -->
    <script src="js/moveTabUp.js"></script>
    <!-- what function is inside: moveTabUp -->
    <script src="js/moveTabDown.js"></script>
    <!-- what function is inside: moveTabDown -->
    <script src="js/forceMigrateOldData.js"></script>
    <!-- what function is inside: forceMigrateOldData -->
    <script src="js/openMoveProfileModal.js"></script>
    <!-- what function is inside: openMoveProfileModal -->
    <script src="js/permanentlyDeleteLink.js"></script>
    <!-- what function is inside: permanentlyDeleteLink -->
    <script src="js/restoreLink.js"></script>
    <!-- what function is inside: restoreLink -->
    <script src="js/addCheckboxesToLinks.js"></script>
    <!-- what function is inside: addCheckboxesToLinks -->
    <script src="js/removeCheckboxesFromAllViews.js"></script>
    <!-- what function is inside: removeCheckboxesFromAllViews -->
    <script src="js/toggleSelectionMode.js"></script>
    <!-- what function is inside: toggleSelectionMode; showSelectionInstructions; hideSelectionInstructions -->
    <script src="js/openSearchLink.js"></script>
    <!-- what function is inside: openSearchLink -->
    <script src="js/openSearchLinkModal.js"></script>
    <!-- what function is inside: openSearchLinkModal -->
    <script src="js/saveSearchLink.js"></script>
    <!-- what function is inside: saveSearchLink -->
    <script src="js/updateSearchLinkPreview.js"></script>
    <!-- what function is inside: updateSearchLinkPreview -->
    <script src="js/openCreateSearchLinkModal.js"></script>
    <!-- what function is inside: openCreateSearchLinkModal -->
    <script src="js/workbook-color-modal.js"></script>
    <!-- what function is inside: workbook-color-modal -->
    <script src="js/updateProfileColor.js"></script>
    <!-- what function is inside: updateProfileColor -->
    <script src="js/openMultiLinkCardLinks.js"></script>
    <!-- what function is inside: openMultiLinkCardLinks -->
    <script src="js/saveEditMultiLinkCard.js"></script>
    <!-- what function is inside: saveEditMultiLinkCard -->
    <script src="js/updateFieldLabelsEdit.js"></script>
    <!-- what function is inside: updateFieldLabelsEdit -->
    <script src="js/addLinkFieldEdit.js"></script>
    <!-- what function is inside: addLinkFieldEdit -->
    <script src="js/openEditMultiLinkCardModal.js"></script>
    <!-- what function is inside: openEditMultiLinkCardModal -->
    <script src="js/saveMultiLinkCard.js"></script>
    <!-- what function is inside: saveMultiLinkCard -->
    <script src="js/updateFieldLabels.js"></script>
    <!-- what function is inside: updateFieldLabels -->
    <script src="js/addLinkField.js"></script>
    <!-- what function is inside: addLinkField -->
    <script src="js/openMultiLinkCardModal.js"></script>
    <!-- what function is inside: openMultiLinkCardModal -->
    <script src="js/openReorderTabsModal.js"></script>
    <!-- what function is inside: openReorderTabsModal -->
    <script src="js/moveEnvironmentUp.js"></script>
    <!-- what function is inside: moveEnvironmentUp -->
    <script src="js/moveEnvironmentDown.js"></script>
    <!-- what function is inside: moveEnvironmentDown -->
    <script src="js/openReorderEnvironmentsModal.js"></script>
    <!-- what function is inside: openReorderEnvironmentsModal -->
    <script src="js/moveProfileDown.js"></script>
    <!-- what function is inside: moveProfileDown -->
    <script src="js/moveProfileUp.js"></script>
    <!-- what function is inside: moveProfileUp -->
    <script src="js/highlightTab.js"></script>
    <!-- what function is inside: highlightTab -->
    <script src="js/highlightEnvironment.js"></script>
    <!-- what function is inside: highlightEnvironment -->
    <script src="js/highlightProfileTab.js"></script>
    <!-- what function is inside: highlightProfileTab -->
    <script src="js/isProfileInCurrentWorkbook.js"></script>
    <!-- what function is inside: isProfileInCurrentWorkbook -->
    <script src="js/isProfileCurrent.js"></script>
    <!-- what function is inside: isProfileCurrent -->
    <script src="js/renderProfileTabs.js"></script>
    <!-- what function is inside: renderProfileTabs -->
    <script src="js/populateWorkbookProfiles.js"></script>
    <!-- what function is inside: populateWorkbookProfiles -->
    <script src="js/openMoveEnvironmentModal.js"></script>
    <!-- what function is inside: openMoveEnvironmentModal -->
    <script src="js/switchProfile.js"></script>
    <!-- what function is inside: switchProfile -->
    <script src="js/deleteProfile.js"></script>
    <!-- what function is inside: deleteProfile -->
    <script src="js/addProfile.js"></script>
    <!-- what function is inside: addProfile -->
    <script src="js/escapeXml.js"></script>
    <!-- what function is inside: escapeXml -->
    <script src="js/validateMultiLinkCard.js"></script>
    <!-- what function is inside: validateMultiLinkCard -->
    <script src="js/processMultiLinkUrls.js"></script>
    <!-- what function is inside: processMultiLinkUrls -->
    <script src="js/createTrashItem.js"></script>
    <!-- what function is inside: createTrashItem -->
    <script src="js/importRegularLink.js"></script>
    <!-- what function is inside: importRegularLink -->
    <script src="js/importMultiLink.js"></script>
    <!-- what function is inside: importMultiLink -->
    <script src="js/importLinks.js"></script>
    <!-- what function is inside: importLinks -->
    <script src="js/importTabs.js"></script>
    <!-- what function is inside: importTabs -->
    <script src="js/importEnvironments.js"></script>
    <!-- what function is inside: importEnvironments -->
    <script src="js/importProfiles.js"></script>
    <!-- what function is inside: importProfiles -->
    <script src="js/importFromXML.js"></script>
    <!-- what function is inside: importFromXML; getElementText; generateId -->
    <script src="js/updateSelectedDestinationPath.js"></script>
    <!-- what function is inside: updateSelectedDestinationPath -->
    <script src="js/populateEnvironmentTabs.js"></script>
    <!-- what function is inside: populateEnvironmentTabs -->
    <script src="js/populateProfileEnvironments.js"></script>
    <!-- what function is inside: populateProfileEnvironments -->
    <script src="js/openMoveTabModal.js"></script>
    <!-- what function is inside: openMoveTabModal -->
    <script src="js/attachLinkEventListeners.js"></script>
    <!-- what function is inside: attachLinkEventListeners -->
    <script src="js/createListViewLink.js"></script>
    <!-- what function is inside: createListViewLink -->
    <script src="js/createTableViewLink.js"></script>
    <!-- what function is inside: createTableViewLink; truncateUrl -->
    <script src="js/renderLinks.js"></script>
    <!-- what function is inside: renderLinks; renderGridView; renderListView; renderTableView -->
    <script src="js/selectTab.js"></script>
    <!-- what function is inside: selectTab -->
    <script src="js/saveReorderedWorkbooks.js"></script>
    <!-- what function is inside: saveReorderedWorkbooks -->
    <script src="js/switchWorkbook.js"></script>
    <!-- what function is inside: switchWorkbook -->
    <script src="js/renderWorkbookTabs.js"></script>
    <!-- what function is inside: renderWorkbookTabs -->
    <script src="js/moveLinkUp.js"></script>
    <!-- what function is inside: moveLinkUp -->
    <script src="js/moveLinkDown.js"></script>
    <!-- what function is inside: moveLinkDown -->
    <script src="js/openReorderLinksModal.js"></script>
    <!-- what function is inside: openReorderLinksModal -->
    <script src="js/updateSelectedTabDestinationPath.js"></script>
    <!-- what function is inside: updateSelectedTabDestinationPath -->
    <script src="js/moveLink.js"></script>
    <!-- what function is inside: moveLink -->
    <script src="js/deleteTab.js"></script>
    <!-- what function is inside: deleteTab -->
    <script src="js/deleteEnvironment.js"></script>
    <!-- what function is inside: deleteEnvironment -->
    <script src="js/addLink.js"></script>
    <!-- what function is inside: addLink -->
    <script src="js/addTab.js"></script>
    <!-- what function is inside: addTab -->
    <script src="js/addEnvironment.js"></script>
    <!-- what function is inside: addEnvironment --> 
    <script src="js/addWorkbook.js"></script>
    <!-- what function is inside: addWorkbook -->
    <script src="js/createDefaultProfile.js"></script>
    <!-- what function is inside: createDefaultProfile -->
    <script src="js/createDefaultWorkbook.js"></script>
    <!-- what function is inside: createDefaultWorkbook -->
    <script src="js/switchViewType.js"></script>
    <!-- what function is inside: switchViewType -->
    <script src="js/saveWorkbooks.js"></script>
    <!-- what function is inside: saveWorkbooks -->
    <script src="js/loadWorkbooks.js"></script>
    <!-- what function is inside: loadWorkbooks -->
    <script src="js/ensureEnvironmentsCollapsed.js"></script> 
    <!-- what function is inside: ensureEnvironmentsCollapsed -->
    <script src="js/migrateOldData.js"></script>
    <!-- what function is inside: migrateOldData -->
    <script src="js/updateWorkbookColor.js"></script>
    <!-- what function is inside: updateWorkbookColor; event listeners for workbook color modal; workbook color picker event listener -->
    <script src="js/positionSearchSuggestions.js"></script>
    <!-- what function is inside: positionSearchSuggestions -->
    <script src="js/hideSearchSuggestions.js"></script>
    <!-- what function is inside: hideSearchSuggestions -->
    <script src="js/navigateToSearchResult.js"></script>
    <!-- what function is inside: navigateToSearchResult -->
    <script src="js/getTypeAbbreviation.js"></script>
    <!-- what function is inside: getTypeAbbreviation -->
    <script src="js/escapeRegex.js"></script>
    <!-- what function is inside: escapeRegex -->
    <script src="js/highlightText.js"></script>
    <!-- what function is inside: highlightText -->
    <script src="js/showSearchSuggestions.js"></script>
    <!-- what function is inside: showSearchSuggestions -->
    <script src="js/updateSearchResultsCount.js"></script>
    <!-- what function is inside: updateSearchResultsCount -->
    <script src="js/trash-bin-functions.js"></script>
    <!-- openTrashBinModal, clearTrashBin, restoreFromTrash, permanentlyDeleteFromTrash, deleteLink, 
     renderTrashBinModal, saveTrashBin, loadTrashBin, createTrashItem, importTrashBin-->
    <script src="js/createTabForClone.js"></script>
    <!-- what function is inside: createTabForClone -->
    <script src="js/createEnvironmentForClone.js"></script>
    <!-- what function is inside: createEnvironmentForClone -->
    <script src="js/saveCloneToTab.js"></script>
    <!-- what function is inside: saveCloneToTab -->
    <script src="js/updateCloneDestinationDisplay.js"></script>
    <!-- what function is inside: updateCloneDestinationDisplay -->
    <script src="js/findProfileById.js"></script>
    <!-- what function is inside: findProfileById -->
    <script src="js/populateEnvironmentTabsForClone.js"></script>
    <!-- what function is inside: populateEnvironmentTabsForClone -->
    <script src="js/populateProfileEnvironmentsForClone.js"></script>
    <!-- what function is inside: populateProfileEnvironmentsForClone -->
    <script src="js/openCloneToTabModal.js"></script>
    <!-- what function is inside: openCloneToTabModal -->
    <script src="js/cloneSelectedLinks.js"></script>
    <!-- what function is inside: cloneSelectedLinks -->
    <script src="js/updateSelectedDestinationDisplay.js"></script>
    <!-- what function is inside: updateSelectedDestinationDisplay -->
    <script src="js/BulkOperations.js"></script>
    <!-- updateBulkSelectionCount, moveSelectedLinks, deleteSelectedLinks, openBulkMoveLinkModal, cloneSelectedLinks, saveBulkMoveLinks
    populateProfileEnvironmentsForBulkMove, populateEnvironmentTabsForBulkMove, createEnvironmentForBulkMove, createTabForBulkMove-->
    <script src="js/SearchFunctions.js"></script>
    <!-- performSearch, clearSearch, applySearchHighlights -->
    <script src="js/counters.js"></script>
    <!-- what function is inside: updateAllCounters; updateWorkbooksCounter; updateProfilesCounter; updateEnvironmentsCounter; updateTabsCounter; updateLinksCounter
    updateWorkbooksCounter; updateProfilesCounter; updateEnvironmentsCounter; updateTabsCounter; updateLinksCounter; refreshCounters -->
    <script src="js/migrateToVersionedStorage.js"></script>
    <!-- what function is inside: migrateToVersionedStorage -->
    <script src="js/testStorageIsolation.js"></script>
    <!-- what function is inside: testStorageIsolation -->
    <script src="js/debugCurrentState.js"></script>
    <!-- what function is inside: debugCurrentState -->
    <script src="js/findDuplicateElements.js"></script>
    <!-- what function is inside: findDuplicateElements -->
    <script src="js/verifyAllFixes.js"></script>
    <!-- what function is inside: verifyAllFixes -->
    <script src="js/outlook-email.js"></script>
    <!-- what function is inside: debugCurrentTabState; debugEnvironmentState; debugTabState; debugLinkState; 
     openOutlookEmailModal; updateEmailPreview; saveOutlookEmailLink; closeOutlookEmailModal; setupOutlookEmailListeners -->
    <script src="js/color-modal.js"></script>
    <!--reorder-block-->
    <script src="js/reorder-workbooks-modal.js"></script>
    <!-- what function is inside: initReorderWorkbooksModal; createModal; setupEventListeners; showModal; hideModal; populateWorkbooksList; saveOrder -->
    <script src="js/reorder-profiles-modal.js"></script>
    <!-- what function is inside: initReorderProfilesModal; createModal; setupEventListeners; showModal; hideModal; populateProfilesList; saveOrder -->
    <script src="js/reorder-environments-modal.js"></script>
    <!-- what function is inside: initReorderEnvironmentsModal; createModal; setupEventListeners; showModal; hideModal; populateEnvironmentsList; saveOrder -->
    <script src="js/reorder-tabs-modal.js"></script>
    <!-- what function is inside: initReorderTabsModal; createModal; setupEventListeners; showModal; hideModal; populateTabsList; saveOrder -->
    <script src="js/reorder-links-modal.js"></script>
    <!-- what function is inside: initReorderLinksModal; createModal; setupEventListeners; showModal; hideModal; populateLinksList; saveOrder -->
    <!--reorder-block ends-->
    <!--rename-block-->
    <script src="js/renameWorkbook.js"></script>
    <!-- what function is inside: renameWorkbook -->
    <script src="js/rename-workbook-modal.js"></script>
    <!-- what function is inside: initRenameWorkbookModal; createModal; setupEventListeners; showModal; hideModal; saveRename -->
    <script src="js/renameProfile.js"></script>
    <!-- what function is inside: renameProfile -->
    <script src="js/rename-profile-modal.js"></script>
    <!-- what function is inside: initRenameProfileModal; createModal; setupEventListeners; showModal; hideModal; saveRename -->
    <script src="js/renameEnvironment.js"></script>
    <!-- what function is inside: renameEnvironment -->
    <script src="js/rename-environment-modal.js"></script>
    <!-- what function is inside: initRenameEnvironmentModal; createModal; setupEventListeners; showModal; hideModal; saveRename -->
    <script src="js/renameTab.js"></script>
    <!-- what function is inside: renameTab -->
    <script src="js/rename-tab-modal.js"></script>
    <!-- what function is inside: initRenameTabModal; createModal; setupEventListeners; showModal; hideModal; saveRename -->
    <script src="js/editLink.js"></script>
    <!-- what function is inside: editLink -->
    <script src="js/isValidUrl.js"></script>
    <!-- what function is inside: isValidUrl -->
    <script src="js/edit-link-modal.js"></script>
    <!-- what function is inside: initEditLinkModal; createModal; setupEventListeners; showModal; hideModal; saveEdit -->
    <script src="js/createLinkCard.js"></script>
    <!-- what function is inside: createLinkCard -->
    <!--rename-block ends-->
    <script src="js/debugXMLImport.js"></script>
    <!-- what function is inside: debugXMLImport -->
    <script src="js/importWorkbooks.js"></script>
    <!-- what function is inside: importWorkbooks -->
    <script src="js/debugExportModal.js"></script>
    <!-- what function is inside: debugExportModal -->
    <!--move-block-->
    <script src="js/moveProfile.js"></script>
    <!-- what function is inside: moveProfile -->
    <script src="js/move-profile-modal.js"></script>
    <!-- what function is inside: initMoveProfileModal; createModal; setupEventListeners; showModal; hideModal; saveMove -->
    <script src="js/moveEnvironment.js"></script>
    <!-- what function is inside: moveEnvironment -->
    <script src="js/move-environment-modal.js"></script>
    <!-- what function is inside: initMoveEnvironmentModal; createModal; setupEventListeners; showModal; hideModal; saveMove -->
    <script src="js/moveTab.js"></script>
    <!-- what function is inside: moveTab -->
    <script src="js/move-tab-modal.js"></script>
    <!-- what function is inside: initMoveTabModal; createModal; setupEventListeners; showModal; hideModal; saveMove -->
    <!--move-block ends-->
    <!-- Color picker modal for profiles -->
    <script src="js/openProfileColorModal.js"></script>
    <!-- what function is inside: openColorModal -->
    <script src="js/fixProfileTabsScrolling.js"></script>
    <!-- what function is inside: fixProfileTabsScrolling -->
    <script src="js/workingProfileTabsScroll.js"></script>
    <!-- what function is inside: workingProfileTabsScroll -->

    <!-- Tree view move tab modal
    <script src="js/move-tab-modal-tree-view.js"></script>
    Tree view move tab modal -->

    <!-- Event listeners LAST -->
    <script src="js/event-listeners.js"></script>
    <!-- what function is inside: attachLinkEventListeners -->
    <!-- Event listeners LAST -->

    
</body>
</html> 